{% extends 'configmanager/__base__.html' %}
{% block title %}发布申请详情 | {% endblock %}
{% block content %}
<h2>发布管理 > 发布申请详情</h2>

{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

<form action="" method="post">
{% csrf_token %}
<table>
    <tbody>
        <tr>
            <th>申请编号</th>
            <td>{{ apply.applyproject }}</td>
        </tr>
        <tr>
            <th>选择发布站点</th>
            <td>
                <table>
                    <th>发布优先级</th>
                    <th>代码类型</th>
                    <th>Jenkins版本号</th>
                    <th>发布站点</th>
                    <th>研发负责人</th>
                    <th>所属ECS</th>
                    <th>发布状态</th>
                    <th>操作</th>
                    <tr>
                        {% for deployitem in apply.deployitem_set.all %}
                            <td>
                                <span>{{ deployitem.deployorderby }}</span>
                            </td>
                            <td>
                                {% if deployitem.type == "T" %}
                                    <span>主干</span>
                                {% else %}
                                    <span>分支</span>
                                {% endif %}
                            </td>
                            <td>
                                <span>{{ deployitem.jenkinsversion }}</span>
                            </td>
                            <td>
                                <span>{{ deployitem.site.fullname }}</span>
                            <td>
                                <span>{{ deployitem.apply.devcharge }}</span>
                            </td>
                            <td>
                                <span>{{ deployitem.site.ECSlists }}</span>
                            </td>
                            <td>
                                <span>{{ deployitem.deploy_status }}</span>
                            </td>
                            <td>
                            </td>
                    </tr>
                        {% endfor %}
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <th valign="top">配置修改说明</th>
            <td>
                <textarea name="confamendexplain" id="id_confamendexplain" rows="15" cols="150">{{ apply.confamendexplain }}</textarea>
            </td>
        </tr>
        <tr>
            <th valign="top">备注事项</th>
            <td>
                <textarea name="remarkexplain" id="id_remarkexplain" rows="15" cols="150">{{ apply.remarkexplain }}</textarea>
            </td>
        </tr>
        <tr>
            <th>状态</th>
            <td> 
                {% if apply.status == "WC" %}
                    <span>待提交</span>
                {% elif apply.status == "WD" %}
                    <span>待发布</span>
                {% elif apply.status == "C" %}
                    <span>已取消</span>
                {% elif apply.status == "D" %}
                    <span>已发布</span>
                {% elif apply.status == "DA" %}
                    <span>研发经理审批中</span>
                {% elif apply.status == "OA" %}
                    <span>运维经理审批中</span>
                {% elif apply.status == "EA" %}
                    <span>运维工程师审批中</span>
                {% elif apply.status == "TA" %}
                    <span>测试经理审批中</span>
                {% elif apply.status == "TDA" %}
                    <span>技术总监审批中</span>
                {% endif %}
            </td>
        </tr>
        <tr>
            <th>申请人</th>
            <td>
                {{ apply.apply_user }}
            </td>
        </tr>
        <tr>
            <th>申请时间</th>
            <td>
                {{ apply.apply_time }}
            </td>
        </tr>
        <tr>
            <th>展开操作日志</th>
            <td>
            </td>
        </tr>
    </tbody>
</table>
<input type="submit" name="apply-save"value="保存" />
<input type="submit" name="apply-goback" value="返回" />
</form>

{% endblock %}
